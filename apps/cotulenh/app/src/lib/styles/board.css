/* Shared Board Styles for CoTuLenh */
/* This file contains theme-agnostic board styles that use CSS variables.
   Theme-specific values are defined in themes/*.css (e.g., .theme-modern-warfare, .theme-classic) */

/* --- Board Background --- */
/* Board grid SVG is shared across all themes - located at /assets/board-grid.svg */
cg-background {
  background-color: var(--theme-board-bg, #eeedef);
  background-image: var(--theme-board-image, url('/assets/board-grid.svg'));
  background-size: cover;
  filter: var(--theme-board-filter, none);
  box-shadow: var(--theme-board-shadow, none);
  border: none;
}

/* Board border overlay */
cg-background::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border: 2px solid var(--theme-board-border);
  box-shadow: 0 0 20px var(--theme-primary-dim);
  pointer-events: none;
}

/* --- Heroic Piece Branding --- */
.cg-wrap piece.heroic,
piece.dragging.heroic,
.ghost-piece piece.heroic {
  filter: var(--theme-piece-heroic-filter);
}

/* Red Team Heroic Override */
.cg-wrap piece.heroic[class*='red'],
piece.dragging.heroic[class*='red'],
.ghost-piece piece.heroic[class*='red'] {
  filter: var(--theme-piece-heroic-filter);
}

/* --- Heroic Star Badge --- */
cg-piece-star {
  position: absolute;
  right: -5%;
  bottom: -5%;
  width: 35%;
  height: 35%;
  min-width: 16px;
  min-height: 16px;
  background-color: var(--theme-heroic-bg);
  border: 1px solid var(--theme-heroic-border);
  border-radius: 50%;
  box-shadow: var(--theme-heroic-glow);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ffd700'%3E%3Cpath d='M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z' stroke='%23eebb00' stroke-width='1.5' stroke-linejoin='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 70%;
  z-index: 10;
}

/* Pulse effect using pseudo-element for GPU acceleration */
cg-piece-star::before {
  content: '';
  position: absolute;
  inset: -1px;
  border: 1px solid #fff;
  border-radius: 50%;
  box-shadow: 0 0 12px var(--theme-heroic-border);
  pointer-events: none;
  will-change: opacity, transform;
  animation: pulse-badge 2s infinite ease-in-out;
}

@keyframes pulse-badge {
  0% {
    opacity: 0.4;
    transform: scale(1);
  }

  50% {
    opacity: 1;
    transform: scale(1.15);
  }

  100% {
    opacity: 0.4;
    transform: scale(1);
  }
}

/* --- Attack Buttons --- */
cg-board cg-btn.piece-attack.stay {
  background-color: var(--theme-btn-attack-stay);
  border: 1px solid #fff;
  box-shadow: 0 0 10px var(--theme-btn-attack-stay);
  background-image: var(--theme-icon-attack-stay);
}

cg-board cg-btn.piece-attack.normal {
  background-color: var(--theme-btn-attack-normal);
  border: 1px solid #fff;
  box-shadow: 0 0 10px var(--theme-btn-attack-normal);
  background-image: var(--theme-icon-attack-normal);
}

cg-board cg-btn.cancel-stack-move {
  background-color: var(--theme-btn-cancel-bg);
  border: 1px solid var(--theme-btn-cancel-border);
  box-shadow: inset 0 0 15px var(--theme-accent-dim);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffab00' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='18' y1='6' x2='6' y2='18'%3E%3C/line%3E%3Cline x1='6' y1='6' x2='18' y2='18'%3E%3C/line%3E%3C/svg%3E");
  background-size: 60%;
  background-repeat: no-repeat;
  background-position: center;
  backdrop-filter: blur(4px);
  transition: var(--theme-transition-base);
}

cg-board cg-btn.cancel-stack-move:hover {
  background-color: var(--theme-accent-dim);
  box-shadow: var(--theme-glow-accent);
  transform: scale(1.05);
}

cg-board cg-btn.complete-stack-move {
  background-color: var(--theme-btn-confirm-bg);
  border: 1px solid var(--theme-btn-confirm-border);
  box-shadow: inset 0 0 15px var(--theme-secondary-dim);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2300ff41' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
  background-size: 60%;
  background-repeat: no-repeat;
  background-position: center;
  backdrop-filter: blur(4px);
  transition: var(--theme-transition-base);
}

cg-board cg-btn.complete-stack-move:hover {
  background-color: var(--theme-secondary-dim);
  box-shadow: var(--theme-glow-secondary);
  transform: scale(1.05);
}

/* --- Interactive Board Squares --- */

/* Destination Markers */
cg-board square.move-dest {
  background:
    linear-gradient(to right, var(--theme-board-move-dest) 2px, transparent 2px) 50% 50% / 14px 2px
      no-repeat,
    linear-gradient(to bottom, var(--theme-board-move-dest) 2px, transparent 2px) 50% 50% / 2px 14px
      no-repeat;
  opacity: 0.9;
}

cg-board square.move-dest:hover {
  background: radial-gradient(circle, var(--theme-primary-dim) 0%, transparent 70%);
  box-shadow: inset 0 0 10px var(--theme-primary);
  opacity: 1;
}

/* Capture Targets */
cg-board square.oc.move-dest {
  background:
    linear-gradient(45deg, var(--theme-board-capture) 2px, transparent 2px) 0 0 / 10px 10px,
    radial-gradient(circle, var(--theme-accent-dim) 0%, transparent 70%);
}

/* Last Move */
cg-board square.last-move.from {
  background-color: var(--theme-board-last-move-from);
  box-shadow: inset 0 0 5px var(--theme-primary);
}

cg-board square.last-move.to {
  position: relative;
  background-color: var(--theme-board-last-move-to);
  box-shadow: inset 0 0 10px var(--theme-primary);
}

/* Pulse glow effect using pseudo-element for GPU acceleration */
cg-board square.last-move.to::before {
  content: '';
  position: absolute;
  inset: 0;
  background-color: var(--theme-primary-dim);
  box-shadow: inset 0 0 15px var(--theme-primary);
  pointer-events: none;
  will-change: opacity;
  animation: pulse-glow 2s infinite;
}

/* Selected Piece */
cg-board square.selected {
  background-color: var(--theme-board-selected);
  box-shadow: inset 0 0 15px var(--theme-secondary);
  border: 1px solid var(--theme-board-selected-border);
}

/* Check / Danger */
cg-board square.check {
  position: relative;
  background: radial-gradient(circle, var(--theme-board-check) 0%, transparent 70%);
}

cg-board square.check::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, var(--theme-board-check) 0%, transparent 70%);
  pointer-events: none;
  will-change: opacity;
  animation: alarm-pulse 1s infinite alternate;
}

/* --- Deploy Mode --- */
cg-board square.deploy-origin {
  background-color: var(--theme-board-deploy-origin);
  border: 1px dashed var(--theme-board-deploy-origin-border);
}

cg-board square.deploy-dest {
  background-color: var(--theme-board-deploy-dest);
  border: 1px dashed var(--theme-board-deploy-dest-border);
}

cg-board square.deploy-incomplete {
  position: relative;
  box-shadow: inset 0 0 20px var(--theme-accent-dim);
}

cg-board square.deploy-incomplete::before {
  content: '';
  position: absolute;
  inset: -1px;
  border: 1px dashed rgba(255, 255, 255, 0.8);
  box-shadow: var(--theme-glow-accent);
  pointer-events: none;
  will-change: opacity;
  animation: pulse-deploy 1.5s ease-in-out infinite;
}

/* --- Air Defense (Radar Zones) --- */

/* Shared base styles */
cg-board square.air-defense-influence {
  z-index: 3;
  --overlap-intensity: 1;
}

/* OFF - No effects at all */
[data-radar-effect='off'] cg-board square.air-defense-influence::before,
[data-radar-effect='off'] cg-board square.air-defense-influence::after {
  display: none;
}

/* MINIMAL - Beautiful static tactical design (best performance) */
[data-radar-effect='minimal'] cg-board square.air-defense-influence::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 80%;
  height: 80%;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  z-index: 8;
  pointer-events: none;

  /* Layered tactical rings - pure CSS, no animation */
  background:
    /* Outer ring - dashed */
    radial-gradient(circle, transparent 68%, currentColor 68%, currentColor 69%, transparent 69%),
    /* Middle ring - solid */
    radial-gradient(circle, transparent 48%, currentColor 48%, currentColor 50%, transparent 50%),
    /* Inner ring - dotted effect */
    radial-gradient(circle, transparent 28%, currentColor 28%, currentColor 29%, transparent 29%),
    /* Center dot */ radial-gradient(circle at center, currentColor 8%, transparent 8%),
    /* Crosshairs - horizontal */
    linear-gradient(to bottom, transparent 49%, currentColor 49%, currentColor 51%, transparent 51%),
    /* Crosshairs - vertical */
    linear-gradient(to right, transparent 49%, currentColor 49%, currentColor 51%, transparent 51%),
    /* Base glow */ radial-gradient(circle, currentColor 0%, transparent 70%);

  opacity: 0.4;
  filter: drop-shadow(0 0 2px currentColor);
}

[data-radar-effect='minimal'] cg-board square.air-defense-influence::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 80%;
  height: 80%;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  z-index: 7;
  pointer-events: none;

  /* Dashed outer ring pattern */
  background: conic-gradient(
    from 0deg,
    currentColor 0deg,
    currentColor 20deg,
    transparent 20deg,
    transparent 40deg,
    currentColor 40deg,
    currentColor 60deg,
    transparent 60deg,
    transparent 80deg,
    currentColor 80deg,
    currentColor 100deg,
    transparent 100deg,
    transparent 120deg,
    currentColor 120deg,
    currentColor 140deg,
    transparent 140deg,
    transparent 160deg,
    currentColor 160deg,
    currentColor 180deg,
    transparent 180deg,
    transparent 200deg,
    currentColor 200deg,
    currentColor 220deg,
    transparent 220deg,
    transparent 240deg,
    currentColor 240deg,
    currentColor 260deg,
    transparent 260deg,
    transparent 280deg,
    currentColor 280deg,
    currentColor 300deg,
    transparent 300deg,
    transparent 320deg,
    currentColor 320deg,
    currentColor 340deg,
    transparent 340deg,
    transparent 360deg
  );

  /* Mask to create dashed ring only on outer edge */
  -webkit-mask: radial-gradient(circle, transparent 68%, black 68%, black 72%, transparent 72%);
  mask: radial-gradient(circle, transparent 68%, black 68%, black 72%, transparent 72%);
  opacity: 0.25;
}

/* PULSE - Pulsing effect (recommended, GPU-accelerated) */
@keyframes air-defense-pulse {
  0%,
  100% {
    transform: translate(-50%, -50%) scale(0.9);
    opacity: 0.5;
  }

  50% {
    transform: translate(-50%, -50%) scale(1.05);
    opacity: 0.3;
  }
}

[data-radar-effect='pulse'] cg-board square.air-defense-influence::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 70%;
  height: 70%;
  transform: translate(-50%, -50%);
  border: 2px solid currentColor;
  border-radius: 50%;
  opacity: 0.5;
  z-index: 9;
  pointer-events: none;
  will-change: transform, opacity;
  animation: air-defense-pulse 2s ease-in-out infinite;
}

[data-radar-effect='pulse'] cg-board square.air-defense-influence::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 50%;
  height: 50%;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background: currentColor;
  opacity: 0.15;
  z-index: 8;
  pointer-events: none;
}

/* SCAN - Full radar scan (CPU intensive, high-end only) */
@keyframes radar-scan {
  0% {
    transform: translate(-50%, -50%) rotate(0deg);
  }

  100% {
    transform: translate(-50%, -50%) rotate(360deg);
  }
}

[data-radar-effect='scan'] cg-board square.air-defense-influence::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 70%;
  height: 70%;
  transform: translate(-50%, -50%);
  border: 1px solid currentColor;
  border-radius: 50%;
  opacity: 0.4;
  box-shadow: 0 0 4px currentColor;
  z-index: 9;
  pointer-events: none;
}

[data-radar-effect='scan'] cg-board square.air-defense-influence::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 68%;
  height: 68%;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background:
    radial-gradient(circle at center, currentColor 2px, transparent 2.5px),
    conic-gradient(from 0deg, transparent 0deg, transparent 270deg, currentColor 360deg);
  opacity: 0.3;
  z-index: 9;
  pointer-events: none;
  will-change: transform;
  animation: radar-scan 2.5s linear infinite;
}

/* Overlap styles for all modes except "off" */
[data-radar-effect='minimal'] cg-board square.air-defense-influence.overlap::before {
  opacity: calc(0.5 + (var(--overlap-intensity) * 0.08));
  filter: drop-shadow(0 0 3px currentColor);
}

[data-radar-effect='minimal'] cg-board square.air-defense-influence.overlap::after {
  opacity: calc(0.35 + (var(--overlap-intensity) * 0.05));
}

[data-radar-effect='pulse'] cg-board square.air-defense-influence.overlap::before,
[data-radar-effect='scan'] cg-board square.air-defense-influence.overlap::before {
  border-width: 2px;
  opacity: calc(0.5 + (var(--overlap-intensity) * 0.1));
}

[data-radar-effect='pulse'] cg-board square.air-defense-influence.overlap::before {
  border-width: 3px;
  opacity: calc(0.6 + (var(--overlap-intensity) * 0.1));
}

[data-radar-effect='pulse'] cg-board square.air-defense-influence.overlap::after {
  opacity: calc(0.2 + (var(--overlap-intensity) * 0.05));
  animation-duration: 1.5s;
}

[data-radar-effect='scan'] cg-board square.air-defense-influence.overlap::before {
  border-width: 2px;
  border-style: dashed;
}

[data-radar-effect='scan'] cg-board square.air-defense-influence.overlap::after {
  opacity: calc(0.3 + (var(--overlap-intensity) * 0.1));
  animation-duration: 1.5s;
}

/* Friendly color variants */
cg-board square.air-defense-influence.friendly {
  color: var(--theme-board-air-friendly);
}

cg-board square.air-defense-influence.opponent {
  color: var(--theme-board-air-opponent);
}

cg-board square.air-defense-influence.opponent.overlap {
  color: var(--theme-board-air-overlap);
}

/* --- Piece Styling --- */
piece {
  transition:
    transform var(--theme-transition-base),
    filter var(--theme-transition-base);
  filter: var(--theme-piece-shadow);
}

piece[class*='blue'] {
  filter: var(--theme-piece-blue-filter);
}

piece[class*='red'] {
  filter: var(--theme-piece-red-filter);
}

piece:hover {
  transform: translateY(-5px) scale(1.1);
  filter: var(--theme-piece-hover-filter);
  z-index: 100;
}

piece.dragging {
  transition: none !important;
  transform: scale(1.1);
  filter: var(--theme-piece-drag-filter) !important;
  z-index: 1000;
  cursor: grabbing;
}

/* --- Animations --- */
@keyframes pulse-glow {
  0%,
  100% {
    opacity: 0.3;
  }

  50% {
    opacity: 0.8;
  }
}

@keyframes alarm-pulse {
  0% {
    opacity: 0.5;
  }

  100% {
    opacity: 0.9;
  }
}

@keyframes pulse-deploy {
  0%,
  100% {
    opacity: 0.3;
  }

  50% {
    opacity: 0.8;
  }
}
